<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <link th:href="@{/css/style.css}" rel="styleSheet">
    <script th:src="@{/js/main.js}"></script>
    <title>パスワード変更</title>
</head>
<body>
<header>
    <div class="header-contents">
        <div class="admin-header">
            <div class="header-links">
                <a class="btn-home" th:href="@{/}">HOME</a>
            </div>
            <div>
                社員番号：<span class="login-user" th:text="${loginUser.account}"></span>
            </div>
        </div>
    </div>
</header>
<main>
    <div class="main-contents">
        <h1 class="title">パスワード変更</h1>

        <div class="password-change-wrapper">
            <form th:method="put" th:action="@{/password/update/{id}(id=${fromModel.id}}" th:object="${formModel}" onsubmit="return confirmSubmit()">
                <div class="errorMessages">
                    <div th:if="${#fields.hasErrors('password')}" th:errors="*{password}"></div>
                    <div th:if="${errorMessages != null}" th:each="errorMessage : ${errorMessages}" th:text="${errorMessage}"></div>
                </div>
                <!-- CSRFトークン -->
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <input type="hidden" th:field="*{id}"/>
                <input type="hidden" th:field="*{account}"/>
                <input type="hidden" th:field="*{name}"/>
                <input type="hidden" th:field="*{departmentId}"/>
                <input type="hidden" th:field="*{authority}"/>
                <input type="hidden" th:field="*{workStart}"/>
                <input type="hidden" th:field="*{workEnd}"/>
                <input type="hidden" th:field="*{restStart}"/>
                <input type="hidden" th:field="*{restEnd}"/>
                <input type="hidden" th:field="*{isStopped}"/>
                <div class="form-area">
                    <label>新しいパスワード（半角6文字以上20文字以下）</label>
                    <div class="password-field">
                        <input type="password" name="password" id="passwordInput"/>
                    </div>
                    <label>パスワード（確認用）</label>
                    <div class="password-field">
                        <input type="password" name="confirmationPassword" id="confirmationPasswordInput"/>
                    </div>
                    <!-- パスワード表示切替チェックボックス -->
                    <div style="display: flex; align-items: center; gap: 0.5em;">
                        <input type="checkbox" id="showPasswordCheckbox" onclick="togglePasswordVisibility()"/>
                        <label for="showPasswordCheckbox">パスワードを表示する</label>
                    </div>
                    <input type="submit" class="btn-submit" value="変更"/>
                </div>
            </form>
        </div>
    </div>
</main>
<footer>
</footer>
<script>
    function togglePasswordVisibility() {
        const passwordInput = document.getElementById('passwordInput');
        const confirmationInput = document.getElementById('confirmationPasswordInput');
        const showPasswordCheckbox = document.getElementById('showPasswordCheckbox');

        const type = showPasswordCheckbox.checked ? 'text' : 'password';

        if (passwordInput) passwordInput.type = type;
        if (confirmationInput) confirmationInput.type = type;
    }

    function confirmSubmit() {
    return confirm('パスワードを変更してもよろしいですか？');
}
</script>
</body>
</html>